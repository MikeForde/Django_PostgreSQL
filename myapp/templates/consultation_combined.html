{% extends "base.html" %}

{% block title %}Consultation & Events | TT-Mick-P{% endblock %}

{% block content %}
<h1>Consultation & Events Combined</h1>
<p>This view shows a single consultation and all associated events from the Event table that have that consultation id</p>
<p>From a user's perspective this is roughly how they would see the consultation</p>
<p>For brevity, the multiple instances of "Fit for Full Duties within current MES" have simply been omitted but would appear only once in the real system</p>
<h2>Consultation Detail</h2>
<p><strong>ID:</strong> {{ consultation.id }}</p>
<p><strong>Patient ID:</strong> {{ consultation.patient_id }}</p>
<p><strong>Assigned Date:</strong> {{ consultation.assigned_date }}</p>
<p><strong>Location:</strong> {{ consultation.location_id }}</p>
<p><strong>Consultation Type:</strong> {{ consultation.consultation_type }}</p>

<h2>Related Events</h2>
<table>
    <thead>
        <tr>
            <th>Combined Text and Codes</th>
        </tr>
    </thead>
    <tbody>
        {% for event in events %}
        <tr>
            <td>{{ event.formatted_text }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4">No related events found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'consultation_list' %}">Back to Consultations</a>
{% endblock %}
